<script type="text/javascript">
  $(function() {
    var myLatlng = new google.maps.LatLng(<%= @location %>);
    var myOptions = {
      zoom: 10,
      center: myLatlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById("map"), myOptions);

    var marker = new google.maps.Marker({
      position: myLatlng,
      map: map,
      title: "Hello World!"
    });

    google.maps.event.addListener(marker, 'click', function() {
      var infowindow = new google.maps.InfoWindow({
        content: 'Change the zoom level',
        position: marker.position
      });

      infowindow.open(map);
    });
  });

  mixpanel.track("View Map", { nickname: "<%= session[:nickname] %>" });

  <% if session[:created_map] %>
    mixpanel.track("Create Map", { nickname: "<%= session[:nickname] %>" });
    <% session[:created_map] = nil %>
  <% end %>
</script>

<div id="map"></div>